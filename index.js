var TinyVideoPlayer=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(){function e(t,e,i,o){var s,n=this,r=this;if("function"!=typeof window.Event){var a=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),i};a.prototype=window.Event.prototype,window.CustomEvent=a}if(s=Array.isArray(t)?t[0]:t,this.instanceName=s.substring(s.lastIndexOf("/")+1,s.lastIndexOf(".")),this.videoWidth=e,this.videoHeight=i,this.options=this.defaultVal(o,{}),this.id=this.defaultVal(this.options.id,this.instanceName),this.container=this.getElem(this.options.container,document.body),this.isTouch=this.isTouch(),!0===this.options.ignoreTouch?this.nativeContols=!1:this.nativeContols=this.isTouch,this.poster=this.options.poster,this.posterTouch=this.options.posterTouch||this.poster,this.startMuted=this.defaultVal(this.options.muted,!1),this.autoplay=this.defaultVal(this.options.autoplay,!1),this.preload=this.defaultVal(this.options.preload,"auto"),this.controls=this.defaultVal(this.options.controls,!0),this.playsinline=this.defaultVal(this.options.playsinline,!0),this.video=document.createElement("video"),this.video.setAttribute("id",this.id+"_video"),this.video.setAttribute("width",e),this.video.setAttribute("height",i),this.video.setAttribute("preload",this.preload),this.playsinline&&this.video.setAttribute("playsinline",""),this.autoplay&&this.video.setAttribute("autoplay",""),this.createSource(t,this.video),this.options.cuepoints){var d=this.options.cuepoints,l=d.length;for(this.cuePoints=[];l--;){var u=d[l];u.time&&("number"!=typeof u.time||isNaN(u.time)||(u.past=!1,this.cuePoints.push(u)))}this.cuePoints=this.cuePoints.sort((function(t,e){return parseFloat(t.time)-parseFloat(e.time)})),this.cueNum=0,this.nextCue=this.cuePoints[this.cueNum],this.video.addEventListener("seeked",(function(){for(var t,e=n.cuePoints.length,i=n.video.currentTime;e--;)(t=n.cuePoints[e]).time>i?(t.past=!1,n.cueNum=e,n.nextCue=n.cuePoints[n.cueNum]):t.past=!0;E()}),!1)}else this.cueNum=-1;function h(t,e){t.url?(e.url=t.url,(t.bw||t.bh)&&(e.bw=r.defaultVal(t.bw,r.iconW),e.bh=r.defaultVal(t.bh,r.iconH),e.bs=";background-size:"+e.bw+"px "+e.bh+"px")):r.icons.url&&(e.url=r.icons.url,(r.icons.bw||r.icons.bh)&&(e.bw=r.defaultVal(r.icons.bw,r.iconW),e.bh=r.defaultVal(r.icons.bh,r.iconH),e.bs=";background-size:"+e.bw+"px "+e.bh+"px")),(t.x||t.y)&&(e.x=r.defaultVal(t.x,0),e.y=r.defaultVal(t.y,0),e.bp=";background-position:"+e.x+"px "+e.y+"px")}function c(t){"number"!=typeof t||isNaN(t)||(r.video.readyState>2?(r.video.currentTime=t,E()):r.video.addEventListener("canplay",(function e(){r.video.removeEventListener("canplay",e,!1),r.video.currentTime=t,E()}),!1))}function p(){r.toggle_play.classList.remove(r.id+"-btn-paused"),r.toggle_play.classList.add(r.id+"-btn-playing"),r.progIntrvl=setInterval(E,42)}function v(){r.toggle_play.classList.remove(r.id+"-btn-playing"),r.toggle_play.classList.add(r.id+"-btn-paused"),clearInterval(r.progIntrvl)}function g(){r.video.muted?(r.toggle_sound.classList.remove(r.id+"-btn-unmuted"),r.toggle_sound.classList.add(r.id+"-btn-muted")):(r.toggle_sound.classList.remove(r.id+"-btn-muted"),r.toggle_sound.classList.add(r.id+"-btn-unmuted"))}function b(t){r.propagation||t.stopPropagation(),r.video.muted?r.video.muted=!1:r.video.muted=!0}function m(t){r.propagation||t.stopPropagation()}function f(t){r.propagation||t.stopPropagation(),r.video.paused?r.video.play():r.video.pause()}function y(t){r.propagation||t.stopPropagation()}function _(t){r.propagation||t.stopPropagation(),c((t.clientX-r.controls.getBoundingClientRect().left)/parseInt(r.seek_hit.getBoundingClientRect().width,10)*r.video.duration)}function w(t){r.propagation||t.stopPropagation(),r.seek_hit.addEventListener("mousemove",x,!1),r.seek_mark.style.visibility="visible"}function k(){r.seek_hit.removeEventListener("mousemove",x,!1),r.seek_mark.style.visibility="hidden"}function x(t){var e=r.video.getBoundingClientRect().width/r.videoWidth;r.seek_mark.style.width=Math.round((t.clientX-r.controls.getBoundingClientRect().left)/e)+"px"}function E(){var t,e=r.video.currentTime;r.nativeContols||((t=e/r.video.duration*100)>100&&(t=100),r.progress.style.width=t+"%",C());if(r.cueNum>-1&&!r.video.seeking&&e>=r.nextCue.time-.02&&!r.nextCue.past){var i=new CustomEvent("cuepoint",{detail:{data:r.nextCue.data,time:r.nextCue.time,actual:e}});r.video.dispatchEvent(i),r.nextCue.past=!0,r.cueNum===r.cuePoints.length-1?r.cueNum=-1:(r.cueNum++,r.nextCue=r.cuePoints[r.cueNum])}}function C(){var t=r.video.buffered;if(t.length>0){var e=t.end(t.length-1)/r.video.duration*100;r.buffer_track.style.width=e+"%"}}this.nativeContols?(this.posterTouch&&this.video.setAttribute("poster",this.posterTouch),this.startMuted&&this.video.setAttribute("muted",""),this.controls&&this.video.setAttribute("controls",""),this.container.appendChild(this.video),this.cuePoints&&(this.video.addEventListener("play",(function(){n.progIntrvl=setInterval(E,42)}),!1),this.video.addEventListener("pause",(function(){clearInterval(n.progIntrvl)}),!1))):(this.poster&&this.video.setAttribute("poster",this.poster),this.propagation=this.defaultVal(this.options.propagation,!0),this.audio=this.defaultVal(this.options.audio,!0),void 0===this.options.right?(this.side="left",this.margin=this.defaultVal(this.options.left,0)):(this.side="right",this.margin=this.defaultVal(this.options.right,0)),this.controlWidth=this.videoWidth-2*this.margin,this.color1={},this.color1.hex=this.defaultVal(this.options.color1,"cc0000"),this.color1.rgbo=this.hexToRgb(this.color1.hex),this.color1.rgb=this.color1.rgbo.r+","+this.color1.rgbo.g+","+this.color1.rgbo.b,this.color2={},this.color2.hex=this.defaultVal(this.options.color2,"ffffff"),this.color2.rgbo=this.hexToRgb(this.color2.hex),this.color2.rgb=this.color2.rgbo.r+","+this.color2.rgbo.g+","+this.color2.rgbo.b,this.icons=this.defaultVal(this.options.icons,{}),this.iconW=this.defaultVal(this.icons.w,15),this.iconH=this.defaultVal(this.icons.h,15),this.barheight=this.defaultVal(this.options.barheight,4),this.below=this.defaultVal(this.options.below,!1),this.height=this.barheight+this.iconH+5,this.below?(this.barbottom=0,this.iconbottom=this.barheight+3):(this.barbottom=this.iconH+10,this.iconbottom=3,this.height+=3),this.wrapper=document.createElement("div"),this.wrapper.setAttribute("id",this.id+"_wrapper"),this.wrapper.style.position="relative",this.wrapper.style.width=this.videoWidth+"px",this.wrapper.style.height=this.videoHeight+"px",this.wrapper.appendChild(this.video),this.container.appendChild(this.wrapper)),this.nativeContols?(this.proxyShowControls=function(t){t?n.video.hasAttribute("controls")||n.video.setAttribute("controls",""):n.video.hasAttribute("controls")&&n.video.removeAttribute("controls")},this.proxyCurrentTime=function(t){n.video.currentTime=t}):(this.proxyShowControls=function(t){n.controls.style.visibility=t?"visible":"hidden"},this.proxyCurrentTime=function(t){c(t)},function(){var t="\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 15 15' enable-background='new 0 0 15 15'%3E%3Cstyle type='text/css'%3E.st0%7Bfill:%23"+r.color1.hex+"%3B%7D%3C/style%3E%3Cpath class='st0' d=",e={bp:"",bs:"",url:t+"'M4 3v9l8-4.5-8-4.5z'/%3E%3C/svg%3E\""},i={bp:"",bs:"",url:t+"'M3 3h3v9h-3v-9zm6 0h3v9h-3v-9z'/%3E%3C/svg%3E\""},o={bp:"",bs:"",url:t+"'M1 5h3l3-3v11l-3-3h-3v-5zM9.3 5.7l-.7.7c.2.3.4.7.4 1.1s-.2.8-.4 1.1l.7.7c.4-.5.7-1.1.7-1.8s-.3-1.3-.7-1.8zm1.4-1.4l-.7.7c.6.6 1 1.5 1 2.5s-.4 1.8-1 2.5l.7.7c.8-.8 1.3-2 1.3-3.2s-.5-2.4-1.3-3.2zm1.4-1.4l-.7.7c1 1 1.6 2.4 1.6 3.9s-.6 2.9-1.6 3.9l.7.7c1.2-1.2 1.9-2.8 1.9-4.6s-.7-3.4-1.9-4.6z'/%3E%3C/svg%3E\""},s={bp:"",bs:"",url:t+"'M1 5h3l3-3v11l-3-3h-3v-5zm13.4.3l-.7-.7-2.2 2.1-2.1-2.1-.7.7 2.1 2.2-2.1 2.1.7.7 2.1-2.1 2.1 2.1.7-.7-2.1-2.2 2.2-2.1z'/%3E%3C/svg%3E\""};r.icons.play&&h(r.icons.play,e),r.icons.pause&&h(r.icons.pause,i),r.icons.unmute&&h(r.icons.unmute,o),r.icons.mute&&h(r.icons.mute,s);var n=0;r.margin<3&&(n=3);var a="."+r.id+"-btn-muted{height:"+r.iconH+"px;width:"+r.iconW+"px;background:url("+s.url+")"+s.bp+s.bs+"}",d="."+r.id+"-btn-unmuted{height:"+r.iconH+"px;width:"+r.iconW+"px;background:url("+o.url+")"+o.bp+o.bs+"}",l="."+r.id+"-btn-playing{height:"+r.iconH+"px;width:"+r.iconW+"px;background:url("+i.url+")"+i.bp+i.bs+"}",u="."+r.id+"-btn-paused{height:"+r.iconH+"px;width:"+r.iconW+"px;background:url("+e.url+")"+e.bp+e.bs+"}",c="#"+r.id+"_toggle_sound,#"+r.id+"_toggle_play{cursor:pointer;bottom:"+r.iconbottom+"px;background-color:rgba("+r.color2.rgb+",0)}",p="#"+r.id+"_toggle_sound:hover,#"+r.id+"_toggle_play:hover{background-color:rgba("+r.color2.rgb+",0.15)}#"+r.id+"_toggle_sound{"+r.side+":"+(r.iconW+3+n)+"px}#"+r.id+"_toggle_play{"+r.side+":"+n+"px}",v="#"+r.id+"_progress{width:0;background-color:#"+r.color1.hex+"}#"+r.id+"_seek_hit{width:100%;height:100%;cursor:pointer;background-color:rgba(0,0,0,0.001)}#"+r.id+"_seek_track{width:100%;background-color:#"+r.color2.hex+";opacity:0.1}#"+r.id+"_buffer_track{width:0;background-color:#"+r.color2.hex+";opacity:0.125}#"+r.id+"_seek_mark{width:0;background-color:#"+r.color1.hex+";opacity:0.25;pointer-events:none}",g="#"+r.id+"_progress,#"+r.id+"_seek_track,#"+r.id+"_seek_mark,#"+r.id+"_buffer_track{bottom:"+r.barbottom+"px;height:"+r.barheight+"px}",b="#"+r.id+"_controls{margin:0 !important;position:absolute;left:"+r.margin+"px;top:"+(r.videoHeight-r.height)+"px;width:"+r.controlWidth+"px;height:"+r.height+"px}",m="#"+r.id+"_controls div{margin:0;position:absolute}";r.writeCSS(m+b+g+v+c+p+a+d+l+u)}(),r.controls=r.createDiv(r.video.parentNode,r.id+"_controls"),r.progress=r.createDiv(r.controls,r.id+"_progress"),r.seek_mark=r.createDiv(r.controls,r.id+"_seek_mark"),r.buffer_track=r.createDiv(r.controls,r.id+"_buffer_track"),r.seek_track=r.createDiv(r.controls,r.id+"_seek_track"),r.seek_hit=r.createDiv(r.controls,r.id+"_seek_hit"),r.toggle_play=r.createDiv(r.controls,r.id+"_toggle_play"),r.toggle_sound=r.createDiv(r.controls,r.id+"_toggle_sound"),!1===r.audio&&(r.toggle_sound.style.visibility="hidden"),v(),r.toggle_sound.addEventListener("click",b,!1),r.toggle_sound.addEventListener("mouseover",m,!1),r.toggle_play.addEventListener("click",f,!1),r.toggle_play.addEventListener("mouseover",y,!1),r.seek_hit.addEventListener("click",_,!1),r.seek_hit.addEventListener("mouseover",w,!1),r.seek_hit.addEventListener("mouseout",k,!1),r.video.addEventListener("progress",C,!1),r.video.addEventListener("loadedmetadata",C,!1),r.video.addEventListener("ended",r.video.pause,!1),r.video.addEventListener("play",p,!1),r.video.addEventListener("pause",v,!1),r.video.addEventListener("volumechange",g,!1),r.startMuted||g(),r.video.muted=r.startMuted,C())}var i,o,s,n=e.prototype;return n.isTouch=function(){var t="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,e=void 0!==window.orientation||navigator.userAgent.match(/iPhone|iPad|iPod|Android|IEMobile|Kindle|Silk|BlackBerry|Opera Mini/i);return t&&e},n.play=function(){this.video.play()},n.pause=function(){this.video.pause()},n.showControls=function(t){this.proxyShowControls(t)},n.writeCSS=function(t){var e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode(t)),document.head.appendChild(e)},n.trace=function(t){window.console&&window.console.log(t)},n.getElem=function(t){return t?"string"==typeof t?/^#|^\./.test(t)?document.querySelector(t):document.getElementById(t):t:document.body},n.createSource=function(t,e){if("string"==typeof t)e.setAttribute("src",t);else for(var i=0;i<t.length;i++){var o=document.createElement("source"),s=t[i].split(".").pop(),n=s;/m4v/.test(s)&&(n="mp4"),/ogv/.test(s)&&(n="ogg"),o.setAttribute("src",t[i]),o.setAttribute("type","video/"+n),e.appendChild(o)}},n.defaultVal=function(t,e){return void 0===t||""===t||typeof t!=typeof e?e:t},n.getStyle=function(t,e){return e?window.getComputedStyle(t,null).getPropertyValue(e):window.getComputedStyle(t,null)},n.createDiv=function(t,e){var i=document.createElement("div");return i.id=e,t.appendChild(i),i},n.hexToRgb=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},n.addEventListener=function(t,e,i){var o=this.defaultVal(i,!1);this.video.addEventListener(t,e,o)},n.removeEventListener=function(t,e,i){var o=this.defaultVal(i,!1);this.video.removeEventListener(t,e,o)},i=e,(o=[{key:"muted",get:function(){return this.video.muted},set:function(t){this.video.muted=t}},{key:"currentTime",get:function(){return this.video.currentTime},set:function(t){this.proxyCurrentTime(t)}},{key:"paused",get:function(){return this.video.paused}},{key:"seeking",get:function(){return this.video.seeking}},{key:"duration",get:function(){return this.video.duration}},{key:"videoElement",get:function(){return this.video}},{key:"controlsElement",get:function(){return this.controls}}])&&t(i.prototype,o),s&&t(i,s),e}()}();
